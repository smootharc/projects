#!/bin/bash


gcalcli --tsv --calendar Medical agenda "365 days ago" "now" | \
awk '

function ltrim(s) { sub(/^[ \t\r\n]+/, "", s); return s }
function rtrim(s) { sub(/[ \t\r\n]+$/, "", s); return s }
function trim(s)  { return rtrim(ltrim(s)); }


BEGIN {
             printf "%s %s %s %s", "Date       ", "Time ", "Weight", "Comment"; print 
             printf "%s %s %s %s", "~~~~~~~~~~ ", "~~~~~", "~~~~~~", "~~~~~~~"; print 
           }

  /Weight/ {
             count+=1; sum+=$6; 
             printf "%-11s %5s %.2f", $1, $2, $6; $1=$2=$3=$4=$5=$6=""; printf " %s\n", trim($0) 
           } 

     END   { 
             print "~~~~~~~~~~~~~~~~~~~~~~~~";
             printf "%17s %s\n", "Average weight:", sum/count 
           }'
