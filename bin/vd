#!/bin/sh

usage () 
{
        echo "Usage: vids OneValidDirectoryName"
        exit 1
}

cleanup ()
{
    test -f "$playlist" && rm "$playlist"
}

# if test -d "$1"; then
#         dirname=$(realpath "$1")
# else
#         usage
# fi

# trap cleanup EXIT

playlist="$(mktemp)"

find ~/Downloads -type f -printf '%C@\0%p\n' | sort -nr | cut -d '' -f 2 | file --mime-type -nNf - | grep 'image' | cut -d: -f 1 > "$playlist"

if ! feh -dqFf "$playlist" &> /dev/null; then

    echo "No images found!"

fi

playlist="$(mktemp)"

#echo "#EXTM3U" > "$playlist"

find ~/Downloads -type f -printf '%C@\0%p\n' | sort -nr | cut -d '' -f 2 | file --mime-type -nNf - | grep 'video' | cut -d: -f 1 >> "$playlist"

if test -s "$playlist" ; then
    
#    sed -i '1s/^/EXTM3U/'
    mpv --really-quiet --playlist="$playlist"

else
    
    echo "No videos found!"

fi

ddl "$1"
